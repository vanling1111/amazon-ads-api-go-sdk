openapi: 3.0.1
info:
  title: Change history
  description: "Provides information about changes made to campaigns, adgroups, ads,\
    \ etc"
  version: "3.0"
servers:
- url: /
paths:
  /history:
    post:
      summary: History of entity changes.
      description: |-
        Returns history of changes for provided event sources that match the filters and time ranges specified. Only events that belong to the authenticated Advertiser can be queried. All times will be in UTC Epoch format. This API accepts identifiers in either the alphamumeric format (default), or the numeric format. If numeric IDs are supplied, then numeric IDs will be returned otherwise, alphanumeric IDs are returned. This API only returns change history for Sponsored Products and Sponsored Brands campaigns. Changes for Sponsored Display campaigns are not returned. Also, it doesn't return information about who made the change.

        **API Versioning:** This API supports versioning through the Accept header. Use `Accept: application/vnd.historyresponse.v1.1+json` to access version 1.1 features. **THEME event type requires version 1.1 or higher.** Without the proper Accept header, THEME requests will return a 400 error.

        **Requires one of these permissions**:
        ["advertiser_campaign_edit","advertiser_campaign_view"]
      operationId: getHistory
      requestBody:
        description: HistoryQuery
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/history_body'
        required: true
      responses:
        "200":
          description: Successful query. Result contains historical events matching
            query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inline_response_200'
        "400":
          description: |-
            Bad Request. Common causes:
            - Invalid event type for API version (e.g., THEME without version 1.1+)
            - Invalid request parameters
            - Malformed request body
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryError'
              examples:
                theme_version_error:
                  summary: THEME requires version 1.1+
                  value:
                    code: 400
                    details: "Invalid request: Error: Key in HistoryEventTypes: THEME\
                      \ is not supported."
        "401":
          description: Unauthorized - Request failed because user is not authenticated
            or is not allowed to invoke the operation.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryError'
        "403":
          description: Forbidden - Request failed because user does not have access
            to a specified resource
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryError'
        "429":
          description: Too Many Requests - Request was rate-limited. Retry later.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryError'
        "500":
          description: Internal Server Error - Something went wrong on the server.
            Retry later and report an error if unresolved.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HistoryError'
components:
  schemas:
    HistoryError:
      type: object
      properties:
        code:
          type: string
          description: The HTTP status code of the response.
        details:
          type: string
          description: A human-readable description of the response.
      description: The error response object.
    HistoryEventType:
      type: object
      properties:
        eventTypeIds:
          type: array
          description: "max of 10 event types. IDs here belong to the EventType. For\
            \ example, if requesting CAMPAGIN as the eventType, these are campaignIds."
          items:
            type: string
        filters:
          type: array
          description: |-
            | Filter | Entity Types |
            ||-|
            | BUDGET_AMOUNT | CAMPAIGN |
            | IN_BUDGET | CAMPAIGN |
            | STATUS | CAMPAIGN, AD_GROUP, AD, KEYWORD, PRODUCT_TARGET, NEGATIVE_KEYWORD |
            | END_DATE | CAMPAIGN |
            | START_DATE | CAMPAIGN |
            | PLACEMENT_GROUP | CAMPAIGN|
            | SMART_BIDDING_STRATEGY | CAMPAIGN |
            | BID_AMOUNT | AD_GROUP |
            | NAME | CAMPAIGN, AD_GROUP |
          items:
            type: string
            enum:
            - BID_AMOUNT
            - BUDGET_AMOUNT
            - END_DATE
            - IN_BUDGET
            - NAME
            - PLACEMENT_GROUP
            - SMART_BIDDING_STRATEGY
            - START_DATE
            - STATUS
        parents:
          type: array
          description: maximum of 10 parents
          items:
            $ref: '#/components/schemas/HistoryEventType_parents'
    HistoryEventTypes:
      type: object
      properties:
        AD:
          $ref: '#/components/schemas/HistoryEventType'
        AD_GROUP:
          $ref: '#/components/schemas/HistoryEventType'
        CAMPAIGN:
          $ref: '#/components/schemas/HistoryEventType'
        KEYWORD:
          $ref: '#/components/schemas/HistoryEventType'
        NEGATIVE_KEYWORD:
          $ref: '#/components/schemas/HistoryEventType'
        PRODUCT_TARGETING:
          $ref: '#/components/schemas/HistoryEventType'
        THEME:
          allOf:
          - $ref: '#/components/schemas/HistoryEventType'
          - description: '**Requires API version 1.1+:** Use Accept header ''application/vnd.historyresponse.v1.1+json'''
      description: "Event types that can be queried. **Note:** THEME event type requires\
        \ API version 1.1 or higher (Accept: application/vnd.historyresponse.v1.1+json)"
    HistoryResponseEvents:
      type: array
      items:
        $ref: '#/components/schemas/HistoryResponseEvents_inner'
      x-schema-name: HistoryResponseEvents
    HistorySortParameter:
      type: object
      properties:
        direction:
          type: string
          default: DESC
          enum:
          - ASC
          - DESC
        key:
          type: string
          enum:
          - DATE
    history_body:
      required:
      - eventTypes
      - fromDate
      - toDate
      type: object
      properties:
        count:
          type: integer
          description: Requested number of results. Default 100. Minimum 50. Maximum
            200.
        eventTypes:
          $ref: '#/components/schemas/HistoryEventTypes'
        fromDate:
          type: integer
          description: Max 90 days of history.
        nextToken:
          type: string
          description: token from previous response to get next set of data.
        pageOffset:
          type: integer
          description: Mutually exclusive with 'nextToken'. Max results with pageOffset
            is 10000. Use nextToken instead for more results.
        sort:
          $ref: '#/components/schemas/HistorySortParameter'
        toDate:
          type: integer
      example:
        count: "200"
        eventTypes:
          THEME:
            filters:
            - STATUS
            parents:
            - adGroupId: "501439770526954"
              campaignId: "350988133398470"
              useProfileIdAdvertiser: "false"
        fromDate: "1704195640000"
        sort:
          direction: DESC
          key: DATE
        toDate: "1704295640000"
    inline_response_200:
      type: object
      properties:
        events:
          $ref: '#/components/schemas/HistoryResponseEvents'
        nextToken:
          type: string
          description: returned if not using pageOffset. Can be used in the request
            to request the next set of results.
        totalResults:
          type: integer
          description: total results matching the query. Only provided for pageOffset
            queries and capped at 10000.
      example:
        totalResults: 6
        nextToken: nextToken
        events:
        - newValue: newValue
          metadata:
            productTargetingType: EXPRESSION
            campaignId: campaignId
            campaignBudgetType: DAILY
            keywordType: KEYWORD_BROAD
            targetingType: targetingType
            theme: theme
            keyword: keyword
            predefinedTarget: CLOSE-MATCH
            placementGroupPosition: DETAIL_PAGE
            targetingExpression: targetingExpression
            adGroupId: adGroupId
            negativeTargetingType: NEGATIVE_KEYWORD_BROAD
          entityType: AD
          changeType: BID_AMOUNT
          entityId: entityId
          previousValue: previousValue
          timestamp: 0
        - newValue: newValue
          metadata:
            productTargetingType: EXPRESSION
            campaignId: campaignId
            campaignBudgetType: DAILY
            keywordType: KEYWORD_BROAD
            targetingType: targetingType
            theme: theme
            keyword: keyword
            predefinedTarget: CLOSE-MATCH
            placementGroupPosition: DETAIL_PAGE
            targetingExpression: targetingExpression
            adGroupId: adGroupId
            negativeTargetingType: NEGATIVE_KEYWORD_BROAD
          entityType: AD
          changeType: BID_AMOUNT
          entityId: entityId
          previousValue: previousValue
          timestamp: 0
    HistoryEventType_parents:
      type: object
      properties:
        adGroupId:
          type: string
        campaignId:
          type: string
        useProfileIdAdvertiser:
          type: boolean
          description: "If true, retrieves events which belong to the associated advertiser"
    HistoryResponseEvents_inner:
      type: object
      properties:
        changeType:
          type: string
          description: |2-

            ChangeTypes for EntityTypes
            | EntityType | Valid Change Types |
            ||--|
            |CAMPAIGN | STATUS, IN_BUDGET, PORTFOLIO, BUDGET_AMOUNT, NAME, START_DATE, END_DATE, SMART_BIDDING_STRATEGY, PLACEMENT_GROUP, CREATED, IS_PREMIUM_BID_ENABLED, PORTFOLIO_ID, BUDGET_DOCUMENT_VERSION, IS_PROCESSING, RULE_BASED_BUDGET_VALUE, APPLICABLE_RULE_NAME, APPLICABLE_RULE_ID, CREATION_DATE, AUTO_TARGETED |
            |AD_GROUP | STATUS, NAME, DEFAULT_BID_AMOUNT|
            |AD | STATUS|
            |KEYWORD | STATUS, BID_AMOUNT|
            |PRODUCT_TARGETING | STATUS, BID_AMOUNT|
            |NEGATIVE_KEYWORD | STATUS|
          enum:
          - BID_AMOUNT
          - BUDGET_AMOUNT
          - DEFAULT_BID_AMOUNT
          - END_DATE
          - IN_BUDGET
          - NAME
          - PLACEMENT_GROUP
          - PORTFOLIO
          - SMART_BIDDING_STRATEGY
          - START_DATE
          - STATUS
        entityId:
          type: string
        entityType:
          type: string
          enum:
          - AD
          - AD_GROUP
          - CAMPAIGN
          - KEYWORD
          - NEGATIVE_KEYWORD
          - PRODUCT_TARGETING
          - THEME
        metadata:
          type: object
          properties:
            adGroupId:
              type: string
            campaignBudgetType:
              type: string
              description: Field only for campaigns
              enum:
              - DAILY
              - LIFETIME_BUDGET
            campaignId:
              type: string
            keyword:
              type: string
              description: Field only for keywords or negative keywords. The keyword
                or phrase this matches.
            keywordType:
              type: string
              description: Field only for keywords
              enum:
              - KEYWORD_BROAD
              - KEYWORD_EXACT
              - KEYWORD_PHRASE
            negativeTargetingType:
              type: string
              description: Field only for negative targeting.
              enum:
              - NEGATIVE_KEYWORD_BROAD
              - NEGATIVE_KEYWORD_EXACT
              - NEGATIVE_KEYWORD_PHRASE
            placementGroupPosition:
              type: string
              description: Field only for campaign placement group change types
              enum:
              - DETAIL_PAGE
              - TOP_OF_SEARCH
            predefinedTarget:
              type: string
              enum:
              - CLOSE-MATCH
              - COMPLEMENTS
              - LOOSE-MATCH
              - SUBSTITUTES
            productTargetingType:
              type: string
              description: Field only for Product Targeting
              enum:
              - EXPRESSION
              - PREDEFINED
            targetingExpression:
              type: string
              description: |-
                Field only for Product Targeting where type = EXPRESSION. Some examples:
                category="Car Seat Canopies & Covers" brand="Munchkin" price<14.9 rating>4.6
                asin="B000NPPATS"
                category="Women's Handbag Accessories"
            targetingType:
              type: string
              description: Field only for THEME event type
            theme:
              type: string
              description: Field only for THEME event type. The theme targeting value.
          example:
            productTargetingType: EXPRESSION
            campaignId: campaignId
            campaignBudgetType: DAILY
            keywordType: KEYWORD_BROAD
            targetingType: targetingType
            theme: theme
            keyword: keyword
            predefinedTarget: CLOSE-MATCH
            placementGroupPosition: DETAIL_PAGE
            targetingExpression: targetingExpression
            adGroupId: adGroupId
            negativeTargetingType: NEGATIVE_KEYWORD_BROAD
        newValue:
          type: string
          description: |2-

            | EntityType | Change Type | Values |
            ||-|--|
            | CAMPAIGN | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED|
            | CAMPAIGN | IN_BUDGET | true or false|
            | CAMPAIGN | PORTFOLIO | portfolioId|
            | CAMPAIGN | BUDGET_AMOUNT | amount in marketplace currency |
            | CAMPAIGN | NAME | campaign name string|
            | CAMPAIGN | START_DATE | unix time|
            | CAMPAIGN | END_DATE | unix time|
            | CAMPAIGN | SMART_BIDDING_STRATEGY | OPTIMIZE_FOR_SALES, LEGACY, MANUAL|
            | CAMPAIGN | PLACEMENT_GROUP | number as percent |
            | AD_GROUP | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | AD_GROUP | NAME | ad group name string |
            | AD_GROUP | DEFAULT_BID_AMOUNT | amount in marketplace currency |
            | AD | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | KEYWORD | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | KEYWORD | BID_AMOUNT | amount in marketplace currency |
            | PRODUCT_TARGETING | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | PRODUCT_TARGETING | BID_AMOUNT | amount in marketplace currency |
            | NEGATIVE_KEYWORD | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
        previousValue:
          type: string
          description: |2-

            | EntityType | Change Type | Values |
            ||-|--|
            | CAMPAIGN | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED|
            | CAMPAIGN | IN_BUDGET | true or false|
            | CAMPAIGN | PORTFOLIO | portfolioId|
            | CAMPAIGN | BUDGET_AMOUNT | amount in marketplace currency |
            | CAMPAIGN | NAME | campaign name string|
            | CAMPAIGN | START_DATE | unix time|
            | CAMPAIGN | END_DATE | unix time|
            | CAMPAIGN | SMART_BIDDING_STRATEGY | OPTIMIZE_FOR_SALES, LEGACY, MANUAL|
            | CAMPAIGN | PLACEMENT_GROUP | number as percent |
            | AD_GROUP | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | AD_GROUP | NAME | ad group name string |
            | AD_GROUP | DEFAULT_BID_AMOUNT | amount in marketplace currency |
            | AD | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | KEYWORD | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | KEYWORD | BID_AMOUNT | amount in marketplace currency |
            | PRODUCT_TARGETING | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
            | PRODUCT_TARGETING | BID_AMOUNT | amount in marketplace currency |
            | NEGATIVE_KEYWORD | STATUS | CREATED, ENABLED, PAUSED, ARCHIVED |
        timestamp:
          type: integer
          description: unix time
      example:
        newValue: newValue
        metadata:
          productTargetingType: EXPRESSION
          campaignId: campaignId
          campaignBudgetType: DAILY
          keywordType: KEYWORD_BROAD
          targetingType: targetingType
          theme: theme
          keyword: keyword
          predefinedTarget: CLOSE-MATCH
          placementGroupPosition: DETAIL_PAGE
          targetingExpression: targetingExpression
          adGroupId: adGroupId
          negativeTargetingType: NEGATIVE_KEYWORD_BROAD
        entityType: AD
        changeType: BID_AMOUNT
        entityId: entityId
        previousValue: previousValue
        timestamp: 0
  responses: {}
  parameters: {}
  examples: {}
  requestBodies: {}
  headers: {}
  securitySchemes: {}
  links: {}
  callbacks: {}
